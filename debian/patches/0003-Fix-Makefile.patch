From: Maykel Moya <mmoya@mmoya.org>
Date: Mon, 22 Oct 2012 11:56:29 +0200
Subject: Fix Makefile

* Do not install thcping6 twice.
* Rename thc-ipv6.8 manpage to attack-toolkit6.8.
* Remove language extension from scripts in $PATH.
* Set prefix to /usr.
* Don't link against OpenSSL libraries as there is not an
  exemption yet.
---
 Makefile |   11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

--- thc-ipv6.orig/Makefile
+++ thc-ipv6/Makefile
@@ -7,25 +7,26 @@
 CFLAGS=-O2
 CFLAGS+=$(if $(HAVE_SSL),-D_HAVE_SSL,)
 LDFLAGS+=-lpcap $(if $(HAVE_SSL),-lssl -lcrypto,)
-PROGRAMS=parasite6 dos-new-ip6 detect-new-ip6 fake_router6 fake_advertise6 fake_solicitate6 fake_mld6 fake_mld26 fake_mldrouter6 flood_mldrouter6 fake_mipv6 redir6 smurf6 alive6 toobig6 rsmurf6 implementation6 implementation6d sendpees6 sendpeesmp6 randicmp6 fuzz_ip6 flood_mld6 flood_mld26 flood_router6 flood_advertise6 flood_solicitate6 trace6 exploit6 denial6 fake_dhcps6 flood_dhcpc6 fake_dns6d fragmentation6 kill_router6 fake_dnsupdate6 ndpexhaust6 detect_sniffer6 dump_router6 fake_router26 flood_router26 passive_discovery6 dnsrevenum6 inverse_lookup6 node_query6 address6 covert_send6 covert_send6d inject_alive6 firewall6 ndpexhaust26 fake_pim6
+NAME_PREFIX=atk6
+PROGRAMS=$(NAME_PREFIX)-parasite6 $(NAME_PREFIX)-dos-new-ip6 $(NAME_PREFIX)-detect-new-ip6 $(NAME_PREFIX)-fake_router6 $(NAME_PREFIX)-fake_advertise6 $(NAME_PREFIX)-fake_solicitate6 $(NAME_PREFIX)-fake_mld6 $(NAME_PREFIX)-fake_mld26 $(NAME_PREFIX)-fake_mldrouter6 $(NAME_PREFIX)-flood_mldrouter6 $(NAME_PREFIX)-fake_mipv6 $(NAME_PREFIX)-redir6 $(NAME_PREFIX)-smurf6 $(NAME_PREFIX)-alive6 $(NAME_PREFIX)-toobig6 $(NAME_PREFIX)-rsmurf6 $(NAME_PREFIX)-implementation6 $(NAME_PREFIX)-implementation6d $(NAME_PREFIX)-sendpees6 $(NAME_PREFIX)-sendpeesmp6 $(NAME_PREFIX)-randicmp6 $(NAME_PREFIX)-fuzz_ip6 $(NAME_PREFIX)-flood_mld6 $(NAME_PREFIX)-flood_mld26 $(NAME_PREFIX)-flood_router6 $(NAME_PREFIX)-flood_advertise6 $(NAME_PREFIX)-flood_solicitate6 $(NAME_PREFIX)-trace6 $(NAME_PREFIX)-exploit6 $(NAME_PREFIX)-denial6 $(NAME_PREFIX)-fake_dhcps6 $(NAME_PREFIX)-flood_dhcpc6 $(NAME_PREFIX)-fake_dns6d $(NAME_PREFIX)-fragmentation6 $(NAME_PREFIX)-kill_router6 $(NAME_PREFIX)-fake_dnsupdate6 $(NAME_PREFIX)-ndpexhaust6 $(NAME_PREFIX)-detect_sniffer6 $(NAME_PREFIX)-dump_router6 $(NAME_PREFIX)-fake_router26 $(NAME_PREFIX)-flood_router26 $(NAME_PREFIX)-passive_discovery6 $(NAME_PREFIX)-dnsrevenum6 $(NAME_PREFIX)-inverse_lookup6 $(NAME_PREFIX)-node_query6 $(NAME_PREFIX)-address6 $(NAME_PREFIX)-covert_send6 $(NAME_PREFIX)-covert_send6d $(NAME_PREFIX)-inject_alive6 $(NAME_PREFIX)-firewall6 $(NAME_PREFIX)-ndpexhaust26 $(NAME_PREFIX)-fake_pim6
 LIBS=thc-ipv6-lib.o
 STRIP=echo
 
-PREFIX=/usr/local
+PREFIX=/usr
 MANPREFIX=${PREFIX}/share/man
 
-all:	$(LIBS) $(PROGRAMS) dnssecwalk dnsdict6 thcping6
+all:	$(LIBS) $(PROGRAMS) $(NAME_PREFIX)-dnssecwalk $(NAME_PREFIX)-dnsdict6 $(NAME_PREFIX)-thcping6
 
-dnssecwalk:	dnssecwalk.c
+$(NAME_PREFIX)-dnssecwalk:	dnssecwalk.c
 	$(CC) $(CFLAGS) -o $@ $^
 
-dnsdict6:	dnsdict6.c
-	$(CC) $(CFLAGS) -o $@ $^ -lpthread -lresolv
+$(NAME_PREFIX)-dnsdict6:	dnsdict6.c
+	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS) $(CPPFLAGS) -lpthread -lresolv
 
-thcping6:	thcping6.c $(LIBS)
+$(NAME_PREFIX)-thcping6:	thcping6.c $(LIBS)
 	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS) -lrt
 
-%:	%.c $(LIBS)
+$(NAME_PREFIX)-%:	%.c $(LIBS)
 	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS) 
 
 strip:	all
@@ -33,12 +34,15 @@
 
 install: all strip
 	install -m0755 -d ${DESTDIR}${PREFIX}/bin
-	install -m0755 $(PROGRAMS) dnsdict6 thcping6 dnssecwalk *.sh ${DESTDIR}${PREFIX}/bin
+	install -m0755 $(PROGRAMS) $(NAME_PREFIX)-dnsdict6 ${DESTDIR}${PREFIX}/bin
+	install -m0755 dos_mld.sh ${DESTDIR}${PREFIX}/bin/$(NAME_PREFIX)-dos_mld
+	install -m0755 extract_hosts6.sh ${DESTDIR}${PREFIX}/bin/$(NAME_PREFIX)-extract_hosts6
+	install -m0755 extract_networks6.sh ${DESTDIR}${PREFIX}/bin/$(NAME_PREFIX)-extract_networks6
 	install -m0755 -d ${DESTDIR}${MANPREFIX}/man8
-	install -m0644 -D thc-ipv6.8 ${DESTDIR}${MANPREFIX}/man8
+	install -m0644 -D thc-ipv6.8 ${DESTDIR}${MANPREFIX}/man8/attack-toolkit6.8
 
 clean:
-	rm -f $(PROGRAMS) dnsdict6 thcping6 dnssecwalk $(LIBS) core DEADJOE *~
+	rm -f $(PROGRAMS) $(NAME_PREFIX)-dnsdict6 $(NAME_PREFIX)-thcping6 $(NAME_PREFIX)-dnssecwalk $(LIBS) core DEADJOE *~
 
 backup:	clean
 	tar czvf ../thc-ipv6-bak.tar.gz *
